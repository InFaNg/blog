---
title: 2的幂次方表示
date: 2020-07-10 20:16:34
tags: [递归, number theory]
categories: ACM
mathjax: true
---
本文将从一道递归的程序设计竞赛水题出发，大致说明递归的基本思路.
<!-- more -->

## 题目
任何一个正整数都可以用2的幂次方表示。例如：
$$137 = 2^7 + 2^3 + 2^0$$

同时约定方次用括号来表示，即ab可表示为a(b)。由此可知，137可表示为：
$$2(7)+2(3)+2(0)$$

进一步：$$7 = 2^2 + 2 + 2^0$$（$2^1$用2表示）。例如：
$$3 = 2 + 2^0$$

所以最后137可表示为：
$$2(2(2)+2+2(0))+2(2+2(0))+2(0)$$

又如：
$$1315 = 2^{10} + 2^8 + 2^5 + 2 + 1$$

所以1315最后可表示为：
$$2(2(2+2(0))+2)+2(2(2+2(0)))+2(2(2)+2(0))+2+2(0)$$

### 输入
一个正整数n (n ≤ 20000)

### 输出
输出为一行，即符合约定的 n 的 0, 2 表示（在表示中不能有空格）

### 输入示例
> 137

### 输出示例
> 2(2(2)+2+2(0))+2(2+2(0))+2(0)

## 分析
由于最终输出数据的“最小单元”只有 `2(0)` 和 `2`，因此本题可使用递归的思路进行解决。递归边界即为 `2(0)` 和 `2`，对于大于或等于三的数，不断分解使其可以用 `2(0)` 和 `2` 来表示。在实际代码中，可对 `n == 1` 与 `n == 2` 的情况直接输出结果并跳出函数，对于 `n >= 3` 的一般情况，则需进行更为细致的分析。

对于 `n >= 3` 的情况，不难看出，可以用 `2(n)` 或 `2` 来表示小于等于它的最大的 2 次幂，如果找到的最大二次幂恰好能够表示该数，那么至此无需任何额外处理。如果不能恰好表示该数，则需加上它的余数，它的余数可用输出一个 `+` 字符并用递归来进行表示。

由此可以得到如下的伪代码:
```cpp
void print(整数 n) {
    if (n 为 1) {
        输出 2(0) 并退出
    }
    if (n 为 2) {
        输出 2 并退出
    }

    输出小于等于n的最大的 2 次幂

    if (n的最大的 2 次幂不能恰好表示n) {
        输出 + 字符
        进行递归
    }
}
```

其中，对于如何找到“小于等于所给整数的最大的 2 次幂”，可以使用 `while` 循环解决。下面给出完整的代码

## 代码
```cpp
#include <cstdio>

void print(int n) {
    // 特殊情况 递归边界
    if (n == 1) {
        printf("2(0)");
        return;
    }

    if (n == 2) {
        printf("2");
        return;
    }

    // 普遍情况
    int i = 1, j  = 0;
    while (i <= n) {
        i *= 2;
        j++;
    }

    i /= 2;
    j--;

    if (j == 1) {
        printf("2");
    }
    else {
        printf("2(");
        print(j);
        printf(")");
    }

    if (n - i != 0) {
        putchar('+');
        print(n - i);
    }
}

int main() {
    int n;
    while (scanf("%d", &n) == 1) {
        print(n);
        putchar('\n');
    }

    return 0;
}
```